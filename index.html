<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wegee - Leaf Pixelation Project</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body, html {
            width: 100%; height: 100%;
            background-color: #ffffff;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: "Malgun Gothic", "Apple SD Gothic Neo", sans-serif;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .content-box {
            width: 22.16%; 
            min-width: 200px;
            aspect-ratio: 4 / 3;
            position: relative;
            background: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        canvas {
            width: 100%;
            height: 100%;
            image-rendering: pixelated; /* 픽셀 느낌 극대화 */
        }

        #credit-screen {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            background-color: #ffffff;
            color: #000; font-size: 9pt; text-align: center;
            opacity: 0; pointer-events: none;
            transition: opacity 1s ease-in-out;
        }

        #credit-screen.visible { opacity: 1; pointer-events: auto; }

        .replay-btn {
            margin-top: 15px; padding: 5px 12px;
            background: none; border: 1px solid #000;
            font-size: 8pt; cursor: pointer;
        }

        @media (max-width: 768px) {
            body { align-items: flex-start; }
            .container { margin-top: 15vh; }
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="content-box">
            <canvas id="pixel-canvas"></canvas>

            <div id="credit-screen">
                <p>Concept & Production: Wegee</p>
                <p>@wegee.eui</p>
                <p>wegee.eui@gmail.com</p>
                <br>
                <p>© 2026. Wegee. All rights reserved.</p>
                <button class="replay-btn" onclick="location.reload()">REPLAY</button>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('pixel-canvas');
        const ctx = canvas.getContext('2d');
        const creditScreen = document.getElementById('credit-screen');

        const DURATION = 400; // 6분 40초 (초 단위)
        let startTime = null;

        // 캔버스 크기 설정
        canvas.width = 400;
        canvas.height = 300;

        // 나뭇잎 이미지를 캔버스에 그리는 함수 (사진 스타일 반영)
        function drawLeaf(context, size) {
            const cx = canvas.width / 2;
            const cy = canvas.height / 2;
            
            // 그림자
            context.fillStyle = 'rgba(0,0,0,0.1)';
            context.beginPath();
            context.ellipse(cx, cy + 60, 40, 10, 0, 0, Math.PI * 2);
            context.fill();

            // 나뭇잎 본체 (사진의 연두색 그라데이션 스타일)
            const grad = context.createRadialGradient(cx, cy, 5, cx, cy, 80);
            grad.addColorStop(0, '#a8e063');
            grad.addColorStop(1, '#56ab2f');
            
            context.fillStyle = grad;
            context.beginPath();
            context.moveTo(cx, cy - 80);
            context.quadraticCurveTo(cx + 70, cy, cx, cy + 80);
            context.quadraticCurveTo(cx - 70, cy, cx, cy - 80);
            context.fill();

            // 잎맥 (중앙 선)
            context.strokeStyle = 'rgba(255,255,255,0.3)';
            context.lineWidth = 2;
            context.beginPath();
            context.moveTo(cx, cy - 70);
            context.lineTo(cx, cy + 70);
            context.stroke();
        }

        function animate(timestamp) {
            if (!startTime) startTime = timestamp;
            const elapsed = (timestamp - startTime) / 1000;
            const progress = Math.min(elapsed / DURATION, 1);

            // 픽셀 크기 계산: 1(원본)에서 시작하여 끝날 때 400(하나의 사각형)으로 증가
            // 처음에는 변화가 거의 없다가 나중에 급격히 커지도록 제곱근 사용
            const pixelSize = 1 + Math.pow(progress, 2) * 399;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            if (progress < 1) {
                // 1. 임시 캔버스에 원본 나뭇잎 그리기
                const offCanvas = document.createElement('canvas');
                offCanvas.width = canvas.width;
                offCanvas.height = canvas.height;
                const offCtx = offCanvas.getContext('2d');
                drawLeaf(offCtx);

                // 2. 메인 캔버스에 작게 그렸다가 크게 확대하여 픽셀화 구현
                const w = canvas.width / pixelSize;
                const h = canvas.height / pixelSize;
                
                ctx.imageSmoothingEnabled = false; // 안티앨리어싱 제거
                ctx.drawImage(offCanvas, 0, 0, canvas.width, canvas.height, 0, 0, w, h);
                ctx.drawImage(canvas, 0, 0, w, h, 0, 0, canvas.width, canvas.height);

                requestAnimationFrame(animate);
            } else {
                // 애니메이션 종료 시 크레딧 표시
                canvas.style.display = 'none';
                creditScreen.classList.add('visible');
            }
        }

        requestAnimationFrame(animate);
    </script>
</body>
</html>
