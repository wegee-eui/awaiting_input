<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wegee - Leaf Pixelation Final</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body, html {
            width: 100%; height: 100%;
            background-color: #ffffff;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: "Malgun Gothic", sans-serif;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .content-box {
            width: 22.16%; 
            min-width: 240px;
            aspect-ratio: 4 / 3;
            position: relative;
            background: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        canvas {
            width: 100%;
            height: 100%;
            image-rendering: pixelated; /* 픽셀 감성 유지 */
        }

        #credit-screen {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            background-color: #ffffff;
            color: #000; font-size: 9pt; text-align: center;
            opacity: 0; pointer-events: none;
            transition: opacity 1.5s ease-in-out;
            z-index: 10;
        }

        #credit-screen.visible { opacity: 1; pointer-events: auto; }

        .replay-btn {
            margin-top: 15px; padding: 5px 12px;
            background: none; border: 1px solid #000;
            font-size: 8pt; cursor: pointer;
        }

        @media (max-width: 768px) {
            body { align-items: flex-start; }
            .container { margin-top: 15vh; }
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="content-box">
            <canvas id="pixel-canvas"></canvas>

            <div id="credit-screen">
                <p>Concept & Production: Wegee</p>
                <p>@wegee.eui</p>
                <p>wegee.eui@gmail.com</p>
                <br>
                <p>© 2026. Wegee. All rights reserved.</p>
                <button class="replay-btn" onclick="location.reload()">REPLAY</button>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('pixel-canvas');
        const ctx = canvas.getContext('2d');
        const creditScreen = document.getElementById('credit-screen');

        const DURATION = 400; // 6분 40초
        let startTime = null;

        // 고해상도 드로잉을 위한 설정
        canvas.width = 400;
        canvas.height = 300;

        function drawLeaf(context) {
            const cx = canvas.width / 2;
            const cy = canvas.height / 2;
            
            context.save();
            context.translate(cx, cy);
            context.rotate(Math.PI / 3.5); // 약 50도 정도 눕힘

            // 1. 아주 둥글둥글한 나뭇잎 형태 (Radius 최적화)
            const drawLeafPath = (w, h) => {
                context.beginPath();
                context.moveTo(0, -h);
                // 베지어 곡선으로 더 통통하고 둥근 형태 구현
                context.bezierCurveTo(w, -h/2, w, h/2, 0, h);
                context.bezierCurveTo(-w, h/2, -w, -h/2, 0, -h);
                context.closePath();
            };

            // 테두리
            context.fillStyle = '#1B5E20'; 
            drawLeafPath(85, 95);
            context.fill();

            // 내부 그라디언트 (보내주신 사진 스타일)
            const leafGrad = context.createRadialGradient(-20, -30, 10, 0, 0, 120);
            leafGrad.addColorStop(0, '#C0CA33'); // 밝은 영역
            leafGrad.addColorStop(0.6, '#689F38'); // 중간 영역
            leafGrad.addColorStop(1, '#1B5E20'); // 진한 영역
            
            context.fillStyle = leafGrad;
            drawLeafPath(80, 90);
            context.fill();

            // 중앙 잎맥 (입체감)
            context.strokeStyle = 'rgba(27, 94, 32, 0.4)';
            context.lineWidth = 4;
            context.lineCap = 'round';
            context.beginPath();
            context.moveTo(0, -80);
            context.lineTo(0, 80);
            context.stroke();

            context.restore();
        }

        function animate(timestamp) {
            if (!startTime) startTime = timestamp;
            const elapsed = (timestamp - startTime) / 1000;
            const progress = Math.min(elapsed / DURATION, 1);

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // 1. 오프스크린 캔버스에 나뭇잎 그리기
            const offCanvas = document.createElement('canvas');
            offCanvas.width = canvas.width;
            offCanvas.height = canvas.height;
            const offCtx = offCanvas.getContext('2d');
            drawLeaf(offCtx);

            // 2. 픽셀 사이즈 계산 (실시간 반영)
            // progress가 1에 가까워질수록 pixelSize가 400까지 증가
            const pixelSize = 1 + (Math.pow(progress, 2.5) * 399);
            
            const w = Math.max(1, canvas.width / pixelSize);
            const h = Math.max(1, canvas.height / pixelSize);
            
            ctx.imageSmoothingEnabled = false;
            
            // 작게 그렸다가 다시 확대하여 픽셀화 (실시간)
            ctx.drawImage(offCanvas, 0, 0, canvas.width, canvas.height, 0, 0, w, h);
            ctx.drawImage(canvas, 0, 0, w, h, 0, 0, canvas.width, canvas.height);

            if (progress < 1) {
                requestAnimationFrame(animate);
            } else {
                // 엔딩: 픽셀이 하나가 되었을 때 서서히 크레딧 표시
                setTimeout(() => {
                    creditScreen.classList.add('visible');
                }, 500);
            }
        }

        requestAnimationFrame(animate);
    </script>
</body>
</html>
